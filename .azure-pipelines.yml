jobs:
  - job: checks
    displayName: static code analysis
    pool:
      vmImage: ubuntu-latest
    steps:
      - task: UsePythonVersion@0
        displayName: Set up python
        inputs:
          versionSpec: 3.8

      - bash: |
          python .azure-pipelines/syntax-validation.py
        displayName: Syntax validation

      - bash: |
          pip install flake8
          python .azure-pipelines/flake8-validation.py
        displayName: Flake8 validation

  - job: linux
    pool:
      vmImage: ubuntu-latest
    strategy:
      matrix:
        maxParallel: 3
        python35:
          PYTHON_VERSION: 3.5
        python36:
          PYTHON_VERSION: 3.6
        python37:
          PYTHON_VERSION: 3.7
        python38:
          PYTHON_VERSION: 3.8

    steps:
    - template: .azure-pipelines/ci.yml

  - job: macOS
    pool:
      vmImage: macOS-latest
    strategy:
      matrix:
        maxParallel: 3
        python35:
          PYTHON_VERSION: 3.5
        python36:
          PYTHON_VERSION: 3.6
        python37:
          PYTHON_VERSION: 3.7
        python38:
          PYTHON_VERSION: 3.8

    steps:
    - template: .azure-pipelines/ci.yml

  - job: windows
    pool:
      vmImage: windows-latest
    strategy:
      matrix:
        maxParallel: 3
        python35:
          PYTHON_VERSION: 3.5
        python36:
          PYTHON_VERSION: 3.6
        python37:
          PYTHON_VERSION: 3.7
        python38:
          PYTHON_VERSION: 3.8

    steps:
    - template: .azure-pipelines/ci.yml
